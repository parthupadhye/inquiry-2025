# Inquiry Framework - Feature Definitions
# Each feature becomes a GitHub issue with associated prompt

project:
  name: inquiry-framework
  repo: parthupadhye/inquiry-2025

labels:
  phases:
    - name: "phase:0-research"
      color: "f9a825"
      description: "Research and planning"
    - name: "phase:1-foundation"
      color: "1d76db"
      description: "CLI and workspace setup"
    - name: "phase:2-contracts"
      color: "0e8a16"
      description: "Types and validation"
    - name: "phase:3-agents"
      color: "d93f0b"
      description: "Agent system"
    - name: "phase:4-data"
      color: "5319e7"
      description: "Neo4j and Firestore"
    - name: "phase:5-workflow"
      color: "fbca04"
      description: "Workflow engine"
  
  components:
    - name: "component:research"
      color: "f9a825"
    - name: "component:pilot"
      color: "ff9800"
    - name: "component:validation"
      color: "9c27b0"
    - name: "component:cli"
      color: "c5def5"
    - name: "component:contracts"
      color: "bfdadc"
    - name: "component:agents"
      color: "d4c5f9"
    - name: "component:neo4j"
      color: "f9d0c4"
    - name: "component:firebase"
      color: "fef2c0"
    - name: "component:workflow"
      color: "e99695"
  
  sizes:
    - name: "size:small"
      color: "c2e0c6"
      description: "< 2 hours"
    - name: "size:medium"
      color: "fef2c0"
      description: "2-4 hours"
    - name: "size:large"
      color: "f9d0c4"
      description: "4-8 hours"

features:
  # ============================================
  # PHASE 0: RESEARCH INFRASTRUCTURE
  # ============================================
  
  "R.0.0":
    title: "Research: Create issue templates and batch script"
    phase: "phase:0-research"
    component: "component:research"
    size: "size:medium"
    description: |
      Create GitHub issue templates and batch creation script for research tracking.
    acceptance_criteria:
      - "Issue templates for domain, industry, spec, validation, pilot"
      - "Batch creation script for GitHub issues"
      - "Script supports --dry-run preview"
      - "Script can filter by type (industries, agents, etc.)"
    files:
      - ".github/ISSUE_TEMPLATE/research-domain.md"
      - ".github/ISSUE_TEMPLATE/research-industry.md"
      - ".github/ISSUE_TEMPLATE/agent-spec.md"
      - ".github/ISSUE_TEMPLATE/agent-validation.md"
      - ".github/ISSUE_TEMPLATE/pilot-task.md"
      - "tools/inquiry-tools/create-research-issues.py"

  # ============================================
  # PHASE 0: DOMAIN RESEARCH
  # ============================================
  
  "R.1.1":
    title: "Research: FTC claim categories and substantiation"
    phase: "phase:0-research"
    component: "component:research"
    size: "size:large"
    description: |
      Create documentation structure for FTC claim categories research.
    acceptance_criteria:
      - "Taxonomy template created"
      - "FTC guidelines template created"
      - "Enforcement actions template created"
      - "Risk patterns template created"
    files:
      - "research/domains/claim-categories/README.md"
      - "research/domains/claim-categories/taxonomy.md"
      - "research/domains/claim-categories/ftc-guidelines.md"
      - "research/domains/claim-categories/enforcement-actions.md"
      - "research/domains/claim-categories/risk-patterns.md"

  "R.1.2":
    title: "Research: Industry-specific requirements structure"
    phase: "phase:0-research"
    component: "component:research"
    size: "size:large"
    description: |
      Create documentation structure for industry-specific claim requirements.
    acceptance_criteria:
      - "Health/Wellness template created"
      - "Financial Services template created"
      - "CPG/Food template created"
      - "Environmental template created"
    files:
      - "research/domains/claim-categories/industry-specific/README.md"
      - "research/domains/claim-categories/industry-specific/health-wellness.md"
      - "research/domains/claim-categories/industry-specific/financial-services.md"
      - "research/domains/claim-categories/industry-specific/cpg-food.md"
      - "research/domains/claim-categories/industry-specific/environmental.md"

  "R.1.3":
    title: "Research: Brief and deliverable types structure"
    phase: "phase:0-research"
    component: "component:research"
    size: "size:medium"
    description: |
      Create documentation structure for brief and deliverable type analysis.
    acceptance_criteria:
      - "Catalog template created"
      - "Extraction patterns template created"
      - "Templates folder created"
      - "Samples folder created"
    files:
      - "research/domains/brief-types/README.md"
      - "research/domains/brief-types/catalog.md"
      - "research/domains/brief-types/extraction-patterns.md"
      - "research/domains/brief-types/templates/"

  "R.1.4":
    title: "Research: Agency workflow mapping structure"
    phase: "phase:0-research"
    component: "component:research"
    size: "size:medium"
    description: |
      Create documentation structure for agency workflow mapping.
    acceptance_criteria:
      - "Workflow map template created"
      - "Stakeholders template created"
      - "Tools audit template created"
      - "Pain points template created"
    files:
      - "research/domains/agency-workflow/README.md"
      - "research/domains/agency-workflow/workflow-map.md"
      - "research/domains/agency-workflow/stakeholders.md"
      - "research/domains/agency-workflow/tools-audit.md"
      - "research/domains/agency-workflow/pain-points.md"

  "R.1.5":
    title: "Research: Source credibility framework structure"
    phase: "phase:0-research"
    component: "component:research"
    size: "size:medium"
    description: |
      Create documentation structure for source credibility framework.
    acceptance_criteria:
      - "Source types template created"
      - "Credibility framework template created"
      - "Expiration rules template created"
    files:
      - "research/domains/sources/README.md"
      - "research/domains/sources/source-types.md"
      - "research/domains/sources/credibility-framework.md"
      - "research/domains/sources/expiration-rules.md"

  # ============================================
  # PHASE 0: INDUSTRY RESEARCH (via batch script)
  # ============================================
  # These are created as GitHub issues, not code features
  # Run: python create-research-issues.py --type=industries

  # R.2.1 - Pharmaceutical/Biotech
  # R.2.2 - Automotive
  # R.2.3 - Technology/SaaS
  # R.2.4 - Telecommunications
  # R.2.5 - Insurance
  # R.2.6 - Real Estate
  # R.2.7 - Education
  # R.2.8 - Cosmetics/Beauty
  # R.2.9 - Alcohol/Beverage
  # R.2.10 - Gaming/Gambling

  # ============================================
  # AGENT SPECIFICATIONS
  # ============================================

  "S.3.1":
    title: "Spec: ClaimExtraction agent"
    phase: "phase:3-agents"
    component: "component:agents"
    size: "size:medium"
    description: |
      Write detailed specification for ClaimExtraction agent.
    acceptance_criteria:
      - "Input/output schemas defined with Zod"
      - "Claim detection rules documented"
      - "Category assignment logic documented"
      - "LLM prompt strategy documented"
      - "15+ test cases created"
      - "Confidence scoring defined"
      - "Edge cases documented"
    files:
      - "research/agents/specifications/claim-extraction-spec.md"
      - "research/agents/test-cases/claim-extraction/"

  "S.3.2":
    title: "Spec: RiskScoring agent"
    phase: "phase:3-agents"
    component: "component:agents"
    size: "size:medium"
    description: |
      Write detailed specification for RiskScoring agent.
    acceptance_criteria:
      - "Scoring algorithm documented"
      - "Risk factors and weights defined"
      - "Category-specific rules documented"
      - "Keyword pattern library created"
      - "15+ test cases created"
      - "Threshold calibration documented"
    files:
      - "research/agents/specifications/risk-scoring-spec.md"
      - "research/agents/test-cases/risk-scoring/"

  "S.3.3":
    title: "Spec: SourceFinder agent"
    phase: "phase:3-agents"
    component: "component:agents"
    size: "size:medium"
    description: |
      Write detailed specification for SourceFinder agent.
    acceptance_criteria:
      - "Input/output schemas defined"
      - "Search strategies per claim type documented"
      - "Source ranking algorithm defined"
      - "API integrations identified"
      - "10+ test cases created"
      - "Fallback strategies documented"
    files:
      - "research/agents/specifications/source-finder-spec.md"
      - "research/agents/test-cases/source-finder/"

  "S.3.4":
    title: "Spec: SourceVerification agent"
    phase: "phase:3-agents"
    component: "component:agents"
    size: "size:large"
    description: |
      Write detailed specification for SourceVerification agent.
    acceptance_criteria:
      - "Verification logic documented"
      - "Support types defined (direct, indirect, partial)"
      - "Confidence calculation documented"
      - "LLM prompt for verification defined"
      - "15+ test cases created"
      - "Dispute handling documented"
    files:
      - "research/agents/specifications/source-verification-spec.md"
      - "research/agents/test-cases/source-verification/"

  "S.3.5":
    title: "Spec: CredibilityScoring agent"
    phase: "phase:3-agents"
    component: "component:agents"
    size: "size:medium"
    description: |
      Write detailed specification for CredibilityScoring agent.
    acceptance_criteria:
      - "Scoring criteria from credibility framework"
      - "Factor weights defined"
      - "Scoring rubrics created"
      - "10+ test cases created"
      - "Minimum thresholds per claim type defined"
    files:
      - "research/agents/specifications/credibility-scoring-spec.md"
      - "research/agents/test-cases/credibility-scoring/"

  "S.3.6":
    title: "Spec: EvidenceExtraction agent"
    phase: "phase:3-agents"
    component: "component:agents"
    size: "size:medium"
    description: |
      Write detailed specification for EvidenceExtraction agent.
    acceptance_criteria:
      - "Evidence types defined (quote, statistic, finding)"
      - "Relevance scoring documented"
      - "LLM prompt for extraction defined"
      - "10+ test cases created"
      - "Location tracking documented"
    files:
      - "research/agents/specifications/evidence-extraction-spec.md"
      - "research/agents/test-cases/evidence-extraction/"

  "S.3.7":
    title: "Spec: ReportGenerator agent"
    phase: "phase:3-agents"
    component: "component:agents"
    size: "size:large"
    description: |
      Write detailed specification for ReportGenerator agent.
    acceptance_criteria:
      - "Report structure/sections defined"
      - "Recommendation logic documented"
      - "Summary generation documented"
      - "Output formats defined (JSON, PDF)"
      - "5+ test cases created"
      - "Legal package format defined"
    files:
      - "research/agents/specifications/report-generator-spec.md"
      - "research/agents/test-cases/report-generator/"

  "S.5.1":
    title: "Spec: BriefProcessor workflow agent"
    phase: "phase:5-workflow"
    component: "component:workflow"
    size: "size:large"
    description: |
      Write detailed specification for BriefProcessor workflow agent.
    acceptance_criteria:
      - "Workflow steps documented"
      - "Step dependencies defined"
      - "Parallel vs sequential execution documented"
      - "Error handling per step defined"
      - "5+ end-to-end test cases created"
      - "Partial result handling documented"
    files:
      - "research/agents/specifications/brief-processor-spec.md"
      - "research/agents/test-cases/brief-processor/"

  # ============================================
  # AGENT VALIDATION
  # ============================================

  "V.3.1":
    title: "Validate: ClaimExtraction agent v1.0"
    phase: "phase:3-agents"
    component: "component:validation"
    size: "size:medium"
    description: |
      Validate ClaimExtraction agent against test cases and pilot data.
    acceptance_criteria:
      - "All test cases pass"
      - "Tested against 5+ real briefs"
      - "Accuracy >90%"
      - "Recall >90%"
      - "Latency <3s avg"
      - "Issues documented"
    files:
      - "research/agents/evaluations/claim-extraction-v1.md"

  "V.3.2":
    title: "Validate: RiskScoring agent v1.0"
    phase: "phase:3-agents"
    component: "component:validation"
    size: "size:medium"
    description: |
      Validate RiskScoring agent against test cases and expert calibration.
    acceptance_criteria:
      - "All test cases pass"
      - "Accuracy vs expert >85%"
      - "False positive rate <15%"
      - "False negative rate <10%"
      - "Latency <500ms avg"
    files:
      - "research/agents/evaluations/risk-scoring-v1.md"

  "V.3.3":
    title: "Validate: SourceVerification agent v1.0"
    phase: "phase:3-agents"
    component: "component:validation"
    size: "size:medium"
    description: |
      Validate SourceVerification agent against test cases and pilot data.
    acceptance_criteria:
      - "All test cases pass"
      - "Accuracy >85%"
      - "Confidence calibration within 10%"
      - "Latency <5s avg"
    files:
      - "research/agents/evaluations/source-verification-v1.md"

  "V.3.4":
    title: "Validate: ReportGenerator agent v1.0"
    phase: "phase:3-agents"
    component: "component:validation"
    size: "size:medium"
    description: |
      Validate ReportGenerator agent against test cases and user feedback.
    acceptance_criteria:
      - "All test cases pass"
      - "User satisfaction >4/5"
      - "Report completeness 100%"
      - "Generation time <10s"
    files:
      - "research/agents/evaluations/report-generator-v1.md"

  "V.5.1":
    title: "Validate: BriefProcessor workflow v1.0"
    phase: "phase:5-workflow"
    component: "component:validation"
    size: "size:large"
    description: |
      Validate BriefProcessor workflow end-to-end.
    acceptance_criteria:
      - "10+ pilot briefs processed successfully"
      - "Success rate >95%"
      - "Total processing time <2 min"
      - "User satisfaction >4/5"
      - "Error recovery tested"
    files:
      - "research/agents/evaluations/brief-processor-v1.md"

  # ============================================
  # PILOT TRACKING
  # ============================================

  "P.1.1":
    title: "Pilot: Agency A onboarding"
    phase: "phase:0-research"
    component: "component:pilot"
    size: "size:large"
    description: |
      Onboard first pilot agency and gather initial feedback.
    acceptance_criteria:
      - "Initial interview completed"
      - "Workflow documented"
      - "5+ sample briefs collected"
      - "Success criteria agreed"
      - "Weekly feedback schedule set"
    files:
      - "research/pilots/agency-a/README.md"
      - "research/pilots/agency-a/workflow.md"
      - "research/pilots/agency-a/briefs/"

  "P.1.2":
    title: "Pilot: Agency A - Month 1 feedback"
    phase: "phase:0-research"
    component: "component:pilot"
    size: "size:medium"
    description: |
      Collect and analyze first month of pilot feedback.
    acceptance_criteria:
      - "Weekly feedback sessions completed"
      - "Issues/bugs documented"
      - "Feature requests captured"
      - "Usage metrics collected"
      - "Month 1 summary written"
    files:
      - "research/pilots/agency-a/feedback/"
      - "research/pilots/agency-a/month-1-summary.md"

  # ============================================
  # PHASE 1: FOUNDATION
  # ============================================
  
  "1.1.1":
    title: "CLI: Package and Commander.js setup"
    phase: "phase:1-foundation"
    component: "component:cli"
    size: "size:medium"
    description: |
      Set up the @inquiry/cli package with Commander.js for command parsing.
    acceptance_criteria:
      - "Package created at packages/inquiry-cli/"
      - "inquiry --help shows usage"
      - "inquiry --version shows version"
      - "inquiry init command exists (stub)"
      - "inquiry g <schematic> command exists (stub)"
      - "Can run locally via npm link"
    files:
      - "packages/inquiry-cli/package.json"
      - "packages/inquiry-cli/tsconfig.json"
      - "packages/inquiry-cli/bin/inquiry.js"
      - "packages/inquiry-cli/src/index.ts"
      - "packages/inquiry-cli/src/commands/init.ts"
      - "packages/inquiry-cli/src/commands/generate.ts"
      - "packages/inquiry-cli/README.md"

  "1.1.2":
    title: "CLI: Template engine with EJS"
    phase: "phase:1-foundation"
    component: "component:cli"
    size: "size:small"
    description: |
      Add EJS template rendering to generate files from templates.
    acceptance_criteria:
      - "EJS installed and configured"
      - "renderTemplate() utility function"
      - "Template helpers: classify, dasherize, camelize"
      - "Can render .ejs files with variables"
    files:
      - "packages/inquiry-cli/src/utils/templates.ts"
      - "packages/inquiry-cli/src/utils/helpers.ts"

  "1.1.3":
    title: "CLI: Interactive prompts with Inquirer"
    phase: "phase:1-foundation"
    component: "component:cli"
    size: "size:small"
    description: |
      Add interactive prompts for missing options using @inquirer/prompts.
    acceptance_criteria:
      - "@inquirer/prompts installed"
      - "promptForMissing() utility"
      - "Support for input, select, confirm prompts"
      - "Commands prompt when required args missing"
    files:
      - "packages/inquiry-cli/src/utils/prompts.ts"

  "1.1.4":
    title: "CLI: Config file loader"
    phase: "phase:1-foundation"
    component: "component:cli"
    size: "size:small"
    description: |
      Load project configuration from inquiry.config.ts file.
    acceptance_criteria:
      - "cosmiconfig installed"
      - "Loads inquiry.config.ts or inquiry.config.js"
      - "Merges with default config"
      - "Config available to all commands"
    files:
      - "packages/inquiry-cli/src/config/loader.ts"
      - "packages/inquiry-cli/src/config/defaults.ts"
      - "packages/inquiry-cli/src/config/schema.ts"

  "1.1.5":
    title: "CLI: File operations utility"
    phase: "phase:1-foundation"
    component: "component:cli"
    size: "size:small"
    description: |
      File system utilities for creating, modifying, and checking files.
    acceptance_criteria:
      - "fs-extra installed"
      - "createFile() with directory creation"
      - "updateFile() for modifying existing files"
      - "fileExists() check"
      - "Dry run support (no actual writes)"
    files:
      - "packages/inquiry-cli/src/utils/files.ts"

  "1.1.6":
    title: "CLI: Console output utilities"
    phase: "phase:1-foundation"
    component: "component:cli"
    size: "size:small"
    description: |
      Pretty console output with colors, spinners, and formatting.
    acceptance_criteria:
      - "chalk and ora installed"
      - "logger.info(), logger.success(), logger.error()"
      - "spinner for async operations"
      - "Respects --verbose flag"
    files:
      - "packages/inquiry-cli/src/utils/logger.ts"

  # ============================================
  # PHASE 1: WORKSPACE INIT
  # ============================================

  "1.2.1":
    title: "CLI: init command implementation"
    phase: "phase:1-foundation"
    component: "component:cli"
    size: "size:medium"
    description: |
      Implement the 'inquiry init' command to set up workspace.
    acceptance_criteria:
      - "Creates /inquiry folder structure"
      - "Creates inquiry.config.ts"
      - "Updates tsconfig.json with path aliases"
      - "Adds @inquiry/* paths"
      - "Works in existing Angular project"
    files:
      - "packages/inquiry-cli/src/commands/init.ts"
      - "packages/inquiry-cli/templates/init/inquiry.config.ts.ejs"
      - "packages/inquiry-cli/templates/init/tsconfig.paths.json.ejs"

  "1.2.2":
    title: "CLI: Inquiry folder structure"
    phase: "phase:1-foundation"
    component: "component:cli"
    size: "size:small"
    description: |
      Define and create the standard Inquiry folder structure.
    acceptance_criteria:
      - "Creates inquiry/ folder"
      - "Creates inquiry/agents/ subfolder"
      - "Creates inquiry/contracts/ subfolder"
      - "Creates inquiry/workflows/ subfolder"
      - "Creates inquiry/graph/ subfolder"
      - "Creates index.ts files for each"
    files:
      - "packages/inquiry-cli/src/structures/workspace.ts"

  # ============================================
  # PHASE 2: CONTRACTS
  # ============================================

  "2.1.1":
    title: "Contracts: Base message types"
    phase: "phase:2-contracts"
    component: "component:contracts"
    size: "size:medium"
    description: |
      Core message envelope and metadata types for all agent communication.
    acceptance_criteria:
      - "InquiryMessage<T> envelope type"
      - "AgentIdentifier type"
      - "MessageMetadata type"
      - "Provenance type"
      - "All properties readonly"
      - "Firestore compatible (no undefined)"
    files:
      - "inquiry/contracts/base.ts"
      - "inquiry/contracts/index.ts"

  "2.1.2":
    title: "Contracts: Agent types"
    phase: "phase:2-contracts"
    component: "component:contracts"
    size: "size:small"
    description: |
      Types for agent definitions, results, and lifecycle.
    acceptance_criteria:
      - "AgentType union type"
      - "AgentConfig interface"
      - "AgentResult<T> type with success/failure"
      - "AgentStatus type"
    files:
      - "inquiry/contracts/agent.ts"

  "2.1.3":
    title: "Contracts: Claim and Source types"
    phase: "phase:2-contracts"
    component: "component:contracts"
    size: "size:medium"
    description: |
      Domain types for claims, sources, and evidence.
    acceptance_criteria:
      - "Claim interface with category, status, confidence"
      - "ClaimCategory union type"
      - "Source interface with credibility"
      - "SourceType union type"
      - "Evidence interface linking claims to sources"
    files:
      - "inquiry/contracts/claim.ts"
      - "inquiry/contracts/source.ts"
      - "inquiry/contracts/evidence.ts"

  "2.1.4":
    title: "Contracts: Verification types"
    phase: "phase:2-contracts"
    component: "component:contracts"
    size: "size:medium"
    description: |
      Types for verification results and certification.
    acceptance_criteria:
      - "VerificationResult interface"
      - "VerificationStatus union type"
      - "ConfidenceScore type with bounds"
      - "CertificationPackage interface"
      - "AuditEntry interface"
    files:
      - "inquiry/contracts/verification.ts"
      - "inquiry/contracts/certification.ts"

  "2.2.1":
    title: "Contracts: Zod validation schemas"
    phase: "phase:2-contracts"
    component: "component:contracts"
    size: "size:medium"
    description: |
      Runtime validation schemas using Zod for all contract types.
    acceptance_criteria:
      - "Zod installed"
      - "Schema for each contract type"
      - "Type inference from schemas"
      - "validate() helper function"
      - "Helpful error messages"
    files:
      - "inquiry/contracts/validation/schemas.ts"
      - "inquiry/contracts/validation/index.ts"

  # ============================================
  # PHASE 3: AGENT SYSTEM
  # ============================================

  "3.1.1":
    title: "Agent: Base agent class"
    phase: "phase:3-agents"
    component: "component:agents"
    size: "size:large"
    description: |
      Abstract base class that all agents extend.
    acceptance_criteria:
      - "BaseAgent<TInput, TOutput> abstract class"
      - "execute() abstract method"
      - "Lifecycle hooks: onInit, beforeExecute, afterExecute, onError"
      - "Built-in logging"
      - "Provenance tracking"
      - "success() and failure() helper methods"
    files:
      - "inquiry/agents/base/base-agent.ts"
      - "inquiry/agents/base/agent-context.ts"
      - "inquiry/agents/base/index.ts"

  "3.1.2":
    title: "Agent: Agent registry"
    phase: "phase:3-agents"
    component: "component:agents"
    size: "size:medium"
    description: |
      Runtime registry for agent discovery and instantiation.
    acceptance_criteria:
      - "AgentRegistry singleton"
      - "register() method"
      - "get() method by type"
      - "list() all registered agents"
      - "Auto-registration via decorator or manifest"
    files:
      - "inquiry/agents/registry/agent-registry.ts"
      - "inquiry/agents/registry/index.ts"

  "3.2.1":
    title: "CLI: Agent generator schematic"
    phase: "phase:3-agents"
    component: "component:cli"
    size: "size:large"
    description: |
      Generate new agents from templates via 'inquiry g agent'.
    acceptance_criteria:
      - "'inquiry g agent <name>' works"
      - "Prompts for agent type if not provided"
      - "Creates agent file, schema, prompt, test"
      - "Updates agent registry"
      - "Updates index exports"
      - "--dry-run shows files without creating"
    files:
      - "packages/inquiry-cli/src/generators/agent/index.ts"
      - "packages/inquiry-cli/src/generators/agent/schema.ts"
      - "packages/inquiry-cli/templates/agent/agent.ts.ejs"
      - "packages/inquiry-cli/templates/agent/schema.ts.ejs"
      - "packages/inquiry-cli/templates/agent/prompt.ts.ejs"
      - "packages/inquiry-cli/templates/agent/test.ts.ejs"
      - "packages/inquiry-cli/templates/agent/index.ts.ejs"

  # ============================================
  # PHASE 4: DATA LAYER
  # ============================================

  "4.1.1":
    title: "Neo4j: Connection client"
    phase: "phase:4-data"
    component: "component:neo4j"
    size: "size:medium"
    description: |
      Neo4j driver wrapper with connection pooling and helpers.
    acceptance_criteria:
      - "neo4j-driver installed"
      - "Neo4jClient class with singleton"
      - "query() method with parameters"
      - "transaction support"
      - "Connection pooling"
      - "Environment-based config"
    files:
      - "inquiry/graph/client.ts"
      - "inquiry/graph/index.ts"

  "4.1.2":
    title: "Neo4j: Docker setup"
    phase: "phase:4-data"
    component: "component:neo4j"
    size: "size:small"
    description: |
      Docker Compose for local Neo4j development.
    acceptance_criteria:
      - "docker-compose.yml for Neo4j"
      - "APOC plugin enabled"
      - "Volume for data persistence"
      - "README with startup instructions"
    files:
      - "infrastructure/neo4j/docker-compose.yml"
      - "infrastructure/neo4j/README.md"

  "4.2.1":
    title: "CLI: Node generator schematic"
    phase: "phase:4-data"
    component: "component:cli"
    size: "size:medium"
    description: |
      Generate Neo4j node types via 'inquiry g node'.
    acceptance_criteria:
      - "'inquiry g node <name>' works"
      - "Creates TypeScript interface"
      - "Creates Cypher constraints"
      - "Creates CRUD query templates"
      - "Updates graph schema index"
    files:
      - "packages/inquiry-cli/src/generators/node/index.ts"
      - "packages/inquiry-cli/templates/node/interface.ts.ejs"
      - "packages/inquiry-cli/templates/node/queries.cypher.ejs"
      - "packages/inquiry-cli/templates/node/constraints.cypher.ejs"

  "4.3.1":
    title: "Neo4j: Inquiry graph schema"
    phase: "phase:4-data"
    component: "component:neo4j"
    size: "size:large"
    description: |
      Core graph schema for claims, sources, and evidence.
    acceptance_criteria:
      - "(:Claim) node with properties"
      - "(:Source) node with credibility"
      - "(:Evidence) node"
      - "(:Content) node for briefs/deliverables"
      - "Relationships: CONTAINS_CLAIM, SUPPORTED_BY, DERIVED_FROM"
      - "Constraints and indexes"
      - "Seed data for testing"
    files:
      - "inquiry/graph/schema/nodes.ts"
      - "inquiry/graph/schema/relationships.ts"
      - "infrastructure/neo4j/migrations/001-initial-schema.cypher"
      - "infrastructure/neo4j/seed/test-data.cypher"

  # ============================================
  # PHASE 5: WORKFLOW
  # ============================================

  "5.1.1":
    title: "Workflow: Definition types"
    phase: "phase:5-workflow"
    component: "component:workflow"
    size: "size:medium"
    description: |
      Types for defining workflows and steps.
    acceptance_criteria:
      - "WorkflowDefinition interface"
      - "WorkflowStep interface"
      - "StepType union (sequential, parallel, conditional)"
      - "Transition interface"
      - "WorkflowExecution interface"
    files:
      - "inquiry/workflows/types/definition.ts"
      - "inquiry/workflows/types/execution.ts"
      - "inquiry/workflows/types/index.ts"

  "5.1.2":
    title: "CLI: Workflow generator schematic"
    phase: "phase:5-workflow"
    component: "component:cli"
    size: "size:medium"
    description: |
      Generate workflows via 'inquiry g workflow'.
    acceptance_criteria:
      - "'inquiry g workflow <name>' works"
      - "Creates workflow definition file"
      - "Creates workflow executor"
      - "Prompts for steps to include"
      - "Updates workflow registry"
    files:
      - "packages/inquiry-cli/src/generators/workflow/index.ts"
      - "packages/inquiry-cli/templates/workflow/definition.ts.ejs"
      - "packages/inquiry-cli/templates/workflow/executor.ts.ejs"

  "5.2.1":
    title: "Workflow: Execution engine"
    phase: "phase:5-workflow"
    component: "component:workflow"
    size: "size:large"
    description: |
      Engine to execute workflows step by step.
    acceptance_criteria:
      - "WorkflowEngine class"
      - "execute() method"
      - "Step execution with agent lookup"
      - "State management between steps"
      - "Error handling and retry"
      - "Execution logging"
    files:
      - "inquiry/workflows/engine/workflow-engine.ts"
      - "inquiry/workflows/engine/step-executor.ts"
      - "inquiry/workflows/engine/index.ts"

# ============================================
# RESEARCH ISSUE DATA
# Used by create-research-issues.py
# ============================================

domains:
  - name: "FTC Advertising"
    slug: "ftc-advertising"
    regulator: "Federal Trade Commission"
    jurisdiction: "United States Federal"
    categories:
      - name: "Health Claims"
        description: "Claims about health benefits, disease treatment/prevention"
        priority: "High"
      - name: "Environmental Claims"
        description: "Green claims, sustainability, eco-friendly"
        priority: "High"
      - name: "Performance Claims"
        description: "Product efficacy, superiority, comparisons"
        priority: "Medium"
      - name: "Endorsement Claims"
        description: "Testimonials, expert endorsements, influencer content"
        priority: "High"
      - name: "Origin Claims"
        description: "Made in USA, country of origin"
        priority: "Medium"
    resources:
      - title: "FTC Advertising Substantiation Policy"
        url: "https://www.ftc.gov/legal-library/browse/ftc-policy-statement-regarding-advertising-substantiation"
      - title: "FTC Health Claims Guidance"
        url: "https://www.ftc.gov/business-guidance/advertising-marketing/health-claims"
      - title: "FTC Green Guides"
        url: "https://www.ftc.gov/business-guidance/resources/environmental-claims-summary-green-guides"
    effort: "Large"
    labels:
      - "high-priority"

  - name: "FDA Drug/Supplement Claims"
    slug: "fda-drugs"
    regulator: "Food and Drug Administration"
    jurisdiction: "United States Federal"
    categories:
      - name: "Drug Claims"
        description: "Treatment, cure, prevention claims requiring FDA approval"
        priority: "High"
      - name: "Structure/Function Claims"
        description: "Dietary supplement claims about body function"
        priority: "High"
      - name: "Nutrient Content Claims"
        description: "Claims about nutritional content levels"
        priority: "Medium"
    resources:
      - title: "FDA Dietary Supplement Labeling Guide"
        url: "https://www.fda.gov/food/dietary-supplements-guidance-documents-regulatory-information"
    effort: "Large"
    labels:
      - "high-priority"

industries:
  - name: "Dietary Supplements"
    slug: "dietary-supplements"
    regulators:
      - "FTC"
      - "FDA"
    market_size: "$50B+ (US)"
    claim_types:
      - type: "Efficacy Claims"
        example: "Boosts immune system by 50%"
        risk: "High"
        regulation: "FTC Health Claims / FDA DSHEA"
      - type: "Structure/Function Claims"
        example: "Supports healthy digestion"
        risk: "Medium"
        regulation: "FDA Structure/Function"
      - type: "Disease Claims"
        example: "Cures diabetes"
        risk: "Very High"
        regulation: "FDA Drug Claims"
    federal_regulations:
      - "DSHEA (Dietary Supplement Health and Education Act)"
      - "FTC Act Section 5"
      - "FDA 21 CFR Part 101"
    state_regulations:
      - "California Prop 65"
      - "New York Truth in Advertising"
    self_regulatory:
      - "NAD (National Advertising Division)"
      - "CRN (Council for Responsible Nutrition)"
    compliance_considerations:
      - "Required FDA disclaimer for structure/function claims"
      - "No disease claims without FDA approval"
      - "Substantiation for efficacy claims"
      - "Clear and conspicuous disclosures"
    pilot_candidates:
      - name: "Major vitamin brand"
        reason: "High volume of health claims"
        priority: "High"
    effort: "Large"
    labels:
      - "high-priority"

  - name: "Cosmetics & Beauty"
    slug: "cosmetics-beauty"
    regulators:
      - "FTC"
      - "FDA"
    market_size: "$80B+ (US)"
    claim_types:
      - type: "Anti-aging Claims"
        example: "Reduces wrinkles by 50%"
        risk: "High"
        regulation: "FTC Health Claims"
      - type: "Performance Claims"
        example: "24-hour moisture"
        risk: "Medium"
        regulation: "FTC Performance Claims"
      - type: "Natural/Organic Claims"
        example: "100% natural ingredients"
        risk: "Medium"
        regulation: "FTC Green Guides"
    federal_regulations:
      - "FD&C Act (cosmetics provisions)"
      - "FTC Act Section 5"
    self_regulatory:
      - "Personal Care Products Council"
    compliance_considerations:
      - "Drug vs cosmetic distinction"
      - "Testing requirements for claims"
      - "Ingredient disclosure requirements"
    effort: "Medium"
    labels:
      - "medium-priority"

  - name: "Financial Services"
    slug: "financial-services"
    regulators:
      - "FTC"
      - "SEC"
      - "CFPB"
      - "FINRA"
    market_size: "$1T+ (US)"
    claim_types:
      - type: "Performance Claims"
        example: "Average returns of 15%"
        risk: "Very High"
        regulation: "SEC Investment Adviser Act"
      - type: "Fee Claims"
        example: "No hidden fees"
        risk: "High"
        regulation: "CFPB UDAP"
      - type: "Comparison Claims"
        example: "Best rates in the industry"
        risk: "High"
        regulation: "FTC/FINRA"
    federal_regulations:
      - "Securities Act of 1933"
      - "Investment Advisers Act of 1940"
      - "CFPB Reg Z (Truth in Lending)"
      - "FINRA Rules"
    compliance_considerations:
      - "Required disclosures for performance claims"
      - "Past performance disclaimers"
      - "APR disclosure requirements"
      - "Risk disclosure requirements"
    effort: "Large"
    labels:
      - "high-priority"

agents:
  - name: "ClaimExtractor"
    type: "Extraction"
    priority: "High"
    complexity: "Medium"
    purpose: |
      Extracts advertising claims from marketing content including web pages,
      social media posts, product descriptions, and advertising copy.
    input_schema: |
      interface ClaimExtractInput {
        content: string;
        contentType: 'webpage' | 'social' | 'ad' | 'email' | 'print';
        metadata?: {
          url?: string;
          brand?: string;
          industry?: string;
        };
      }
    output_schema: |
      interface ClaimExtractOutput {
        claims: Array<{
          id: string;
          text: string;
          category: ClaimCategory;
          confidence: number;
          location: { start: number; end: number };
        }>;
        contentSummary: string;
      }
    required_inputs:
      - "content - The raw text/HTML to analyze"
      - "contentType - Type of content for context"
    optional_inputs:
      - "metadata - Additional context about the content"
    output_fields:
      - "claims - Array of extracted claims with metadata"
      - "contentSummary - Brief summary of the content"
    capabilities:
      - "Extract explicit claims from text"
      - "Identify implied claims"
      - "Classify claim types"
      - "Locate claims within source text"
      - "Assign confidence scores"
    processing_logic: |
      1. Parse and clean input content
      2. Use LLM to identify potential claims
      3. Classify each claim by category
      4. Calculate confidence based on explicitness
      5. Return structured claim data
    upstream_agents:
      - "None (entry point)"
    downstream_agents:
      - "ClaimClassifier"
      - "RiskScorer"
    latency_target: "<3s p95"
    throughput_target: "10 pages/min"
    accuracy_target: ">90% recall"
    prompt_notes: |
      Focus on marketing language patterns. Watch for:
      - Superlatives (best, #1, only)
      - Performance claims (works, effective, proven)
      - Health claims (healthy, cures, prevents)
      - Comparisons (better than, outperforms)
    test_scenarios:
      - "Simple product page with 3 clear claims"
      - "Social media post with implied claims"
      - "Complex landing page with 10+ claims"
      - "Content with no claims"
      - "Content with ambiguous statements"
    effort: "Large"
    related_domain: "FTC Advertising"
    labels:
      - "core-agent"

  - name: "RiskScorer"
    type: "Analysis"
    priority: "High"
    complexity: "Medium"
    purpose: |
      Assigns risk scores to extracted claims based on claim type,
      language patterns, and regulatory context.
    input_schema: |
      interface RiskScoreInput {
        claim: {
          text: string;
          category: ClaimCategory;
        };
        industry?: string;
        hasSubstantiation?: boolean;
      }
    output_schema: |
      interface RiskScoreOutput {
        score: number;  // 0-100
        level: 'low' | 'medium' | 'high' | 'critical';
        factors: Array<{
          factor: string;
          weight: number;
          contribution: number;
        }>;
        recommendations: string[];
      }
    capabilities:
      - "Score claims on 0-100 risk scale"
      - "Identify risk factors"
      - "Weight factors by importance"
      - "Provide risk-based recommendations"
    latency_target: "<500ms p95"
    accuracy_target: ">85% vs expert"
    test_scenarios:
      - "Low-risk puffery claim"
      - "High-risk health claim"
      - "Critical disease claim"
      - "Claim with substantiation"
      - "Industry-specific high-risk claim"
    effort: "Medium"
    related_domain: "FTC Advertising"
    labels:
      - "core-agent"

  - name: "SourceVerifier"
    type: "Verification"
    priority: "High"
    complexity: "High"
    purpose: |
      Verifies whether provided sources adequately substantiate
      a given claim according to FTC standards.
    input_schema: |
      interface SourceVerifyInput {
        claim: {
          text: string;
          category: ClaimCategory;
        };
        sources: Array<{
          id: string;
          content: string;
          type: SourceType;
          metadata: SourceMetadata;
        }>;
      }
    output_schema: |
      interface SourceVerifyOutput {
        verdict: 'supported' | 'partially_supported' | 'not_supported' | 'contradicted';
        confidence: number;
        analysis: {
          sourceId: string;
          supportLevel: 'direct' | 'indirect' | 'none';
          relevance: number;
          gaps: string[];
        }[];
        overallGaps: string[];
      }
    capabilities:
      - "Evaluate source-claim alignment"
      - "Assess source quality and relevance"
      - "Identify substantiation gaps"
      - "Provide confidence-weighted verdicts"
    latency_target: "<5s p95"
    accuracy_target: ">85%"
    test_scenarios:
      - "Claim with strong supporting source"
      - "Claim with weak/tangential source"
      - "Claim with contradicting source"
      - "Claim with multiple sources"
      - "Claim requiring RCT-level evidence"
    effort: "Large"
    related_domain: "FTC Advertising"
    labels:
      - "core-agent"

pilots:
  - name: "Supplement Brand Alpha"
    industry: "Dietary Supplements"
    agents:
      - "ClaimExtractor"
      - "RiskScorer"
    source_type: "Website"
    source_url: "TBD - pilot partner website"
    data_volume: "50 product pages"
    date_range: "2024-01-01 to 2024-12-31"
    in_scope:
      - "Product detail pages"
      - "Health benefit claims"
      - "Structure/function claims"
    out_of_scope:
      - "User reviews"
      - "Blog content"
      - "Social media"
    detection_target: ">90%"
    accuracy_target: ">85%"
    success_criteria:
      - "Process all 50 pages without errors"
      - "Detection rate meets 90% target"
      - "Classification accuracy meets 85% target"
      - "No critical bugs"
    prerequisites:
      - "ClaimExtractor v1.0 validated"
      - "RiskScorer v1.0 validated"
      - "Industry research complete"
    effort: "Large"
    labels:
      - "pilot"
      - "high-priority"
